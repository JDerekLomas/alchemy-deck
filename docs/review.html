<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alchemy Deck - Card Review</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: #1a1a2e;
      color: #eee;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    h1 {
      color: #d4af37;
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    .progress {
      background: #333;
      border-radius: 10px;
      height: 8px;
      margin: 15px 0;
      overflow: hidden;
    }

    .progress-bar {
      background: linear-gradient(90deg, #d4af37, #f4cf47);
      height: 100%;
      transition: width 0.3s;
    }

    .progress-text {
      color: #888;
      font-size: 0.9rem;
    }

    .card-display {
      display: flex;
      gap: 30px;
      margin-bottom: 30px;
    }

    .card-image {
      flex: 0 0 300px;
    }

    .card-image img {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    }

    .card-info {
      flex: 1;
    }

    .card-category {
      color: #d4af37;
      text-transform: uppercase;
      font-size: 0.8rem;
      letter-spacing: 2px;
      margin-bottom: 5px;
    }

    .card-title {
      font-size: 2rem;
      margin-bottom: 5px;
    }

    .card-subtitle {
      color: #888;
      font-size: 1.1rem;
      margin-bottom: 15px;
    }

    .card-prompt {
      background: rgba(255,255,255,0.05);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      line-height: 1.5;
    }

    .card-quote {
      color: #d4af37;
      font-style: italic;
      font-size: 0.95rem;
    }

    .rating-section {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 20px;
    }

    .rating-section h3 {
      margin-bottom: 20px;
      color: #d4af37;
    }

    .rating-buttons {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .rating-btn {
      flex: 1;
      padding: 20px;
      border: 2px solid #444;
      background: transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .rating-btn:hover {
      border-color: #666;
      background: rgba(255,255,255,0.05);
    }

    .rating-btn.selected {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.1);
    }

    .rating-btn .emoji {
      font-size: 2.5rem;
    }

    .rating-btn .label {
      color: #aaa;
      font-size: 0.85rem;
    }

    .rating-btn.selected .label {
      color: #d4af37;
    }

    .rating-btn.thumbs-up.selected { border-color: #4ade80; background: rgba(74, 222, 128, 0.1); }
    .rating-btn.thumbs-up.selected .label { color: #4ade80; }

    .rating-btn.meh.selected { border-color: #fbbf24; background: rgba(251, 191, 36, 0.1); }
    .rating-btn.meh.selected .label { color: #fbbf24; }

    .rating-btn.thumbs-down.selected { border-color: #f87171; background: rgba(248, 113, 113, 0.1); }
    .rating-btn.thumbs-down.selected .label { color: #f87171; }

    .comment-section {
      margin-bottom: 15px;
    }

    .comment-section label {
      display: block;
      margin-bottom: 8px;
      color: #888;
    }

    textarea {
      width: 100%;
      padding: 15px;
      border: 2px solid #444;
      background: #222;
      color: #eee;
      border-radius: 8px;
      font-family: inherit;
      font-size: 1rem;
      resize: vertical;
      min-height: 100px;
    }

    textarea:focus {
      outline: none;
      border-color: #d4af37;
    }

    textarea::placeholder {
      color: #666;
    }

    .nav-buttons {
      display: flex;
      gap: 15px;
      justify-content: space-between;
    }

    .nav-btn {
      padding: 15px 40px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .nav-btn.prev {
      background: #333;
      color: #eee;
    }

    .nav-btn.prev:hover {
      background: #444;
    }

    .nav-btn.next {
      background: linear-gradient(135deg, #d4af37, #f4cf47);
      color: #1a1a2e;
      font-weight: 600;
    }

    .nav-btn.next:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3);
    }

    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .summary-section {
      margin-top: 40px;
      padding: 30px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
    }

    .summary-section h2 {
      color: #d4af37;
      margin-bottom: 20px;
    }

    .summary-stats {
      display: flex;
      gap: 30px;
      margin-bottom: 20px;
    }

    .stat {
      text-align: center;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: bold;
    }

    .stat-label {
      color: #888;
      font-size: 0.9rem;
    }

    .stat.good .stat-number { color: #4ade80; }
    .stat.meh .stat-number { color: #fbbf24; }
    .stat.bad .stat-number { color: #f87171; }

    .export-btn {
      padding: 15px 30px;
      background: #d4af37;
      color: #1a1a2e;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
    }

    .filter-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 8px 16px;
      border: 1px solid #444;
      background: transparent;
      color: #888;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .filter-btn.active {
      border-color: #d4af37;
      color: #d4af37;
    }

    @media (max-width: 768px) {
      .card-display {
        flex-direction: column;
      }

      .card-image {
        flex: none;
        max-width: 280px;
        margin: 0 auto;
      }

      .rating-buttons {
        flex-direction: row;
      }

      .rating-btn .emoji {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Alchemy Deck Review</h1>
      <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="progress-text" id="progressText">Card 1 of 34</div>

      <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all">All (34)</button>
        <button class="filter-btn" data-filter="unreviewed">Unreviewed</button>
        <button class="filter-btn" data-filter="up">Approved</button>
        <button class="filter-btn" data-filter="meh">Needs Work</button>
        <button class="filter-btn" data-filter="down">Rejected</button>
      </div>
    </header>

    <div class="card-display">
      <div class="card-image">
        <img id="cardImage" src="" alt="">
      </div>
      <div class="card-info">
        <div class="card-category" id="cardCategory"></div>
        <h2 class="card-title" id="cardTitle"></h2>
        <div class="card-subtitle" id="cardSubtitle"></div>
        <div class="card-prompt" id="cardPrompt"></div>
        <div class="card-quote" id="cardQuote"></div>
      </div>
    </div>

    <div class="rating-section">
      <h3>Rate this card</h3>
      <div class="rating-buttons">
        <button class="rating-btn thumbs-up" data-rating="up">
          <span class="emoji">üëç</span>
          <span class="label">Good to print</span>
        </button>
        <button class="rating-btn meh" data-rating="meh">
          <span class="emoji">üòê</span>
          <span class="label">Needs tweaking</span>
        </button>
        <button class="rating-btn thumbs-down" data-rating="down">
          <span class="emoji">üëé</span>
          <span class="label">Regenerate</span>
        </button>
      </div>

      <div class="comment-section">
        <label>Comments / Improvement suggestions:</label>
        <textarea id="commentInput" placeholder="e.g., 'Image too dark', 'Quote doesn't fit theme', 'Text hard to read'..."></textarea>
      </div>
    </div>

    <div class="nav-buttons">
      <button class="nav-btn prev" id="prevBtn">‚Üê Previous</button>
      <button class="nav-btn next" id="nextBtn">Next ‚Üí</button>
    </div>

    <div class="summary-section" id="summarySection" style="display: none;">
      <h2>Review Summary</h2>
      <div class="summary-stats">
        <div class="stat good">
          <div class="stat-number" id="goodCount">0</div>
          <div class="stat-label">Approved</div>
        </div>
        <div class="stat meh">
          <div class="stat-number" id="mehCount">0</div>
          <div class="stat-label">Needs Work</div>
        </div>
        <div class="stat bad">
          <div class="stat-number" id="badCount">0</div>
          <div class="stat-label">Rejected</div>
        </div>
      </div>
      <button class="export-btn" id="exportBtn">Export Review Data (JSON)</button>
    </div>
  </div>

  <script>
    // Card data
    const cards = [
      // STAGES
      { id: "stage-01", category: "Stage", title: "Nigredo", subtitle: "Blackening", prompt: "The dark night. What must die for transformation to begin? What shadow must you face?", quote: '"Let it be digested to blackness." ‚ÄîDrebbel' },
      { id: "stage-02", category: "Stage", title: "Albedo", subtitle: "Whitening", prompt: "The washing. What is being purified? What clarity is emerging from chaos?", quote: '"Water washes and purifies all imperfect things." ‚ÄîSendivogius' },
      { id: "stage-03", category: "Stage", title: "Citrinitas", subtitle: "Yellowing", prompt: "The dawning. What wisdom is emerging? What is coming into consciousness?", quote: '"The dawn breaks, the breakthrough-maker reveals himself." ‚ÄîB√∂hme' },
      { id: "stage-04", category: "Stage", title: "Rubedo", subtitle: "Reddening", prompt: "The completion. What wholeness is possible? What is being integrated?", quote: '"Fire purifies all fixed things and by fire they are perfected." ‚ÄîSendivogius' },
      // OPERATIONS
      { id: "op-01", category: "Operation", title: "Calcination", subtitle: "Burning", prompt: "Reduction by fire. What must be burned away? What attachments need releasing?", quote: '"All impurities of things are purified by fire." ‚ÄîSendivogius' },
      { id: "op-02", category: "Operation", title: "Dissolution", subtitle: "Dissolving", prompt: "Breaking down in water. What structures need to dissolve? Where must you surrender?", quote: '"Water joins together everything that is dissolved." ‚ÄîSendivogius' },
      { id: "op-03", category: "Operation", title: "Separation", subtitle: "Discerning", prompt: "Sorting and discerning. What must be separated? What distinction needs making?", quote: '"Fire separates everything that is joined." ‚ÄîSendivogius' },
      { id: "op-04", category: "Operation", title: "Conjunction", subtitle: "Uniting", prompt: "Marriage of opposites. What opposites seek union? What must be joined?", quote: '"Water joins together everything that is dissolved." ‚ÄîSendivogius' },
      { id: "op-05", category: "Operation", title: "Fermentation", subtitle: "Inspiring", prompt: "New life from decay. What new life is fermenting? What inspiration is arising?", quote: '"Nature gives motion, motion excites air, air excites fire." ‚ÄîSendivogius' },
      { id: "op-06", category: "Operation", title: "Distillation", subtitle: "Refining", prompt: "Extracting essence. What is the essence? What needs further refinement?", quote: '"It is necessary to purify it... then to distill it." ‚ÄîDrebbel' },
      { id: "op-07", category: "Operation", title: "Coagulation", subtitle: "Manifesting", prompt: "Making solid. What is ready to manifest? How does spirit become matter?", quote: '"According to the matrix, various things are produced." ‚ÄîSendivogius' },
      // ELEMENTS
      { id: "elem-01", category: "Element", title: "Fire", subtitle: "Will", prompt: "The transforming principle. Where is the fire? What needs transforming action?", quote: '"Fire purifies all fixed things." ‚ÄîSendivogius' },
      { id: "elem-02", category: "Element", title: "Water", subtitle: "Emotion", prompt: "The dissolving principle. What are the feelings? What needs to flow?", quote: '"Water washes and purifies all imperfect things." ‚ÄîSendivogius' },
      { id: "elem-03", category: "Element", title: "Air", subtitle: "Thought", prompt: "The communicating principle. What thoughts are present? What needs communicating?", quote: '"Motion excites air, air excites fire." ‚ÄîSendivogius' },
      { id: "elem-04", category: "Element", title: "Earth", subtitle: "Body", prompt: "The grounding principle. What is the material reality? What needs grounding?", quote: '"Earth receives the Tincture." ‚ÄîSendivogius' },
      { id: "elem-05", category: "Element", title: "Quintessence", subtitle: "Spirit", prompt: "The fifth element. What is the spiritual dimension? What transcends?", quote: '"The Quintessence is eternal, immutable, perfect in all elements." ‚ÄîDrebbel' },
      // PRINCIPLES
      { id: "prin-01", category: "Principle", title: "Sulphur", subtitle: "Soul", prompt: "The combustible principle. What does the soul desire? What animates this?", quote: '"Fire separates, purifies, digests, and colors." ‚ÄîSendivogius' },
      { id: "prin-02", category: "Principle", title: "Mercury", subtitle: "Spirit", prompt: "The volatile principle. What message is being carried? What moves between realms?", quote: '"He is the true living Mercurius." ‚ÄîHellwig' },
      { id: "prin-03", category: "Principle", title: "Salt", subtitle: "Body", prompt: "The fixed principle. What is the body of this? What form does it take?", quote: '"The Sun is fire, salt, and base." ‚ÄîParacelsus' },
      // VESSELS
      { id: "vessel-01", category: "Vessel", title: "Athanor", subtitle: "The Furnace", prompt: "Sustained heat over time. What requires sustained attention? Where is patience needed?", quote: '"Apply a gentle fire, increasing by degrees." ‚ÄîRosicrucian MS' },
      { id: "vessel-02", category: "Vessel", title: "Alembic", subtitle: "The Still", prompt: "The vessel of distillation. What needs distilling? How to extract the essence?", quote: '"Distillation is the purification of liquids." ‚ÄîRosicrucian MS' },
      { id: "vessel-03", category: "Vessel", title: "Crucible", subtitle: "The Test", prompt: "The vessel of trial. What is being tested? What must withstand the fire?", quote: '"Reveal the eternal gold of the human soul." ‚ÄîHilarionus' },
      { id: "vessel-04", category: "Vessel", title: "Retort", subtitle: "The Return", prompt: "The vessel of circulation. What needs to circulate? What must return to its source?", quote: '"It always begins there where it ends." ‚ÄîHermes' },
      // SAGES
      { id: "sage-01", category: "Sage", title: "Hermes", subtitle: "Trismegistus", prompt: "The thrice-great. How does the macrocosm mirror the microcosm?", quote: '"Man bore the image of his father." ‚ÄîPymander' },
      { id: "sage-02", category: "Sage", title: "Paracelsus", subtitle: "The Physician", prompt: "Nature as teacher. What does nature teach here? What is the medicine?", quote: '"The art of Nature teaches." ‚ÄîBook of Meteors' },
      { id: "sage-03", category: "Sage", title: "Boehme", subtitle: "The Mystic", prompt: "Divine spark in all things. What is the divine spark here? What vision is possible?", quote: '"The soul is a spark of the divine air." ‚ÄîKhunrath' },
      { id: "sage-04", category: "Sage", title: "Ficino", subtitle: "The Translator", prompt: "The soul's journey. What is the soul's path here? Where is the beauty?", quote: '"Pleasure is perfection of apprehension itself." ‚ÄîOn Pleasure' },
      { id: "sage-05", category: "Sage", title: "Sendivogius", subtitle: "The Adept", prompt: "The new light. What does practical wisdom say? What is the clear path?", quote: '"Nothing achieves perfection without a seed."' },
      { id: "sage-06", category: "Sage", title: "Agrippa", subtitle: "The Magus", prompt: "Hidden philosophy. What hidden forces are at work? What correspondences apply?", quote: '"Whence come the hidden virtues of things." ‚ÄîAgrippa' },
      // ARCANA
      { id: "arc-01", category: "Arcana", title: "Prima Materia", subtitle: "First Matter", prompt: "Chaos before creation. What is the raw material? What potential lies unformed?", quote: '"The Prima Materia is a divine mist." ‚ÄîHellwig' },
      { id: "arc-02", category: "Arcana", title: "Lapis", subtitle: "The Stone", prompt: "The philosopher's stone. What is the goal? What would complete the work?", quote: '"Praised by Hermes in the Emerald Tablet." ‚ÄîHellwig' },
      { id: "arc-03", category: "Arcana", title: "Ouroboros", subtitle: "Eternal Return", prompt: "The serpent eating its tail. What cycle is completing? What contains its own renewal?", quote: '"It always begins there where it ends." ‚ÄîHermes' },
      { id: "arc-04", category: "Arcana", title: "Rebis", subtitle: "The Double", prompt: "Union of sun and moon. What dualities seek resolution? What would integration look like?", quote: '"He wished to create, and fell to the sphere of generation." ‚ÄîHermes' },
      { id: "arc-05", category: "Arcana", title: "Elixir", subtitle: "The Medicine", prompt: "Universal medicine. What is the medicine needed? What would heal this?", quote: '"Medicine heals the body, music the spirit, theology the soul." ‚ÄîFicino' }
    ];

    // State
    let currentIndex = 0;
    let currentFilter = 'all';
    let filteredCards = [...cards];
    let reviews = JSON.parse(localStorage.getItem('alchemyDeckReviews') || '{}');

    // DOM elements
    const cardImage = document.getElementById('cardImage');
    const cardCategory = document.getElementById('cardCategory');
    const cardTitle = document.getElementById('cardTitle');
    const cardSubtitle = document.getElementById('cardSubtitle');
    const cardPrompt = document.getElementById('cardPrompt');
    const cardQuote = document.getElementById('cardQuote');
    const commentInput = document.getElementById('commentInput');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const summarySection = document.getElementById('summarySection');

    function applyFilter(filter) {
      currentFilter = filter;
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === filter);
      });

      if (filter === 'all') {
        filteredCards = [...cards];
      } else if (filter === 'unreviewed') {
        filteredCards = cards.filter(c => !reviews[c.id]?.rating);
      } else {
        filteredCards = cards.filter(c => reviews[c.id]?.rating === filter);
      }

      currentIndex = 0;
      updateDisplay();
      updateFilterCounts();
    }

    function updateFilterCounts() {
      const counts = {
        all: cards.length,
        unreviewed: cards.filter(c => !reviews[c.id]?.rating).length,
        up: cards.filter(c => reviews[c.id]?.rating === 'up').length,
        meh: cards.filter(c => reviews[c.id]?.rating === 'meh').length,
        down: cards.filter(c => reviews[c.id]?.rating === 'down').length
      };

      document.querySelectorAll('.filter-btn').forEach(btn => {
        const filter = btn.dataset.filter;
        btn.textContent = `${btn.textContent.split('(')[0].trim()} (${counts[filter]})`;
      });
    }

    function updateDisplay() {
      if (filteredCards.length === 0) {
        cardImage.src = '';
        cardCategory.textContent = '';
        cardTitle.textContent = 'No cards match filter';
        cardSubtitle.textContent = '';
        cardPrompt.textContent = 'Try selecting a different filter.';
        cardQuote.textContent = '';
        return;
      }

      const card = filteredCards[currentIndex];
      const review = reviews[card.id] || {};

      cardImage.src = `cards/${card.id}.png`;
      cardImage.alt = card.title;
      cardCategory.textContent = card.category;
      cardTitle.textContent = card.title;
      cardSubtitle.textContent = card.subtitle;
      cardPrompt.textContent = card.prompt;
      cardQuote.textContent = card.quote;
      commentInput.value = review.comment || '';

      // Update rating buttons
      document.querySelectorAll('.rating-btn').forEach(btn => {
        btn.classList.toggle('selected', btn.dataset.rating === review.rating);
      });

      // Update progress
      const progress = ((currentIndex + 1) / filteredCards.length) * 100;
      progressBar.style.width = `${progress}%`;
      progressText.textContent = `Card ${currentIndex + 1} of ${filteredCards.length}`;

      // Update nav buttons
      prevBtn.disabled = currentIndex === 0;
      nextBtn.textContent = currentIndex === filteredCards.length - 1 ? 'Finish Review' : 'Next ‚Üí';

      // Update summary
      updateSummary();
    }

    function saveReview(rating) {
      const card = filteredCards[currentIndex];
      if (!reviews[card.id]) reviews[card.id] = {};
      reviews[card.id].rating = rating;
      reviews[card.id].comment = commentInput.value;
      reviews[card.id].timestamp = new Date().toISOString();
      localStorage.setItem('alchemyDeckReviews', JSON.stringify(reviews));
      updateDisplay();
      updateFilterCounts();
    }

    function saveComment() {
      const card = filteredCards[currentIndex];
      if (!reviews[card.id]) reviews[card.id] = {};
      reviews[card.id].comment = commentInput.value;
      localStorage.setItem('alchemyDeckReviews', JSON.stringify(reviews));
    }

    function updateSummary() {
      const reviewedCount = Object.keys(reviews).filter(k => reviews[k].rating).length;
      if (reviewedCount > 0) {
        summarySection.style.display = 'block';
        document.getElementById('goodCount').textContent = Object.values(reviews).filter(r => r.rating === 'up').length;
        document.getElementById('mehCount').textContent = Object.values(reviews).filter(r => r.rating === 'meh').length;
        document.getElementById('badCount').textContent = Object.values(reviews).filter(r => r.rating === 'down').length;
      }
    }

    function exportReviews() {
      const exportData = {
        exported: new Date().toISOString(),
        summary: {
          total: cards.length,
          approved: Object.values(reviews).filter(r => r.rating === 'up').length,
          needsWork: Object.values(reviews).filter(r => r.rating === 'meh').length,
          rejected: Object.values(reviews).filter(r => r.rating === 'down').length,
          unreviewed: cards.filter(c => !reviews[c.id]?.rating).length
        },
        cards: cards.map(card => ({
          ...card,
          review: reviews[card.id] || { rating: null, comment: '' }
        }))
      };

      const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `alchemy-deck-review-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
    }

    // Event listeners
    document.querySelectorAll('.rating-btn').forEach(btn => {
      btn.addEventListener('click', () => saveReview(btn.dataset.rating));
    });

    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => applyFilter(btn.dataset.filter));
    });

    commentInput.addEventListener('blur', saveComment);

    prevBtn.addEventListener('click', () => {
      if (currentIndex > 0) {
        currentIndex--;
        updateDisplay();
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentIndex < filteredCards.length - 1) {
        currentIndex++;
        updateDisplay();
      }
    });

    document.getElementById('exportBtn').addEventListener('click', exportReviews);

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.target === commentInput) return;

      if (e.key === 'ArrowLeft' && currentIndex > 0) {
        currentIndex--;
        updateDisplay();
      } else if (e.key === 'ArrowRight' && currentIndex < filteredCards.length - 1) {
        currentIndex++;
        updateDisplay();
      } else if (e.key === '1') saveReview('up');
      else if (e.key === '2') saveReview('meh');
      else if (e.key === '3') saveReview('down');
    });

    // Init
    updateDisplay();
    updateFilterCounts();
  </script>
</body>
</html>
