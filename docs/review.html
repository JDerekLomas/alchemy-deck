<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alchemy Deck - Card Review v2</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600&family=Cormorant+Garamond:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: #2a2420;
      color: #eee;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    h1 {
      color: #d4af37;
      font-family: 'Cinzel', serif;
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    .progress {
      background: #333;
      border-radius: 10px;
      height: 8px;
      margin: 15px 0;
      overflow: hidden;
    }

    .progress-bar {
      background: linear-gradient(90deg, #d4af37, #f4cf47);
      height: 100%;
      transition: width 0.3s;
    }

    .progress-text {
      color: #888;
      font-size: 0.9rem;
    }

    .review-area {
      display: flex;
      gap: 40px;
      margin-bottom: 30px;
      align-items: flex-start;
    }

    /* === CARD STYLES (EXACTLY matching print.html) === */
    .card-wrapper {
      flex: 0 0 auto;
    }

    .card {
      width: 2.5in;
      height: 3.5in;
      border-radius: 0.125in;
      overflow: hidden;
      background: #1a1612;
      display: flex;
      flex-direction: column;
      border: 1px solid #3d3530;
      box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      transform: scale(1.5);
      transform-origin: top left;
      margin-bottom: 100px;
      margin-right: 100px;
    }

    .card .artwork {
      height: 1.9in;
      overflow: hidden;
      background: linear-gradient(135deg, #2a2420 0%, #1a1612 100%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card .artwork img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
    }

    .card .text-panel {
      padding: 8px 10px 5px;
      border-top: 2px solid rgba(212, 175, 55, 0.4);
    }

    .card .category {
      font-family: 'Cinzel', serif;
      font-size: 8px;
      font-weight: 600;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .card .title {
      font-family: 'Cinzel', serif;
      font-size: 15px;
      font-weight: 600;
      color: #fff;
      line-height: 1.1;
    }

    .card .subtitle {
      font-family: 'Cormorant Garamond', serif;
      font-size: 11px;
      font-style: italic;
      color: rgba(255,255,255,0.7);
      margin-top: 1px;
    }

    .card .prompt-area {
      padding: 6px 10px;
      font-size: 10px;
      line-height: 1.4;
      color: #fff;
      flex: 1;
      overflow: hidden;
      font-family: 'Cormorant Garamond', serif;
      font-weight: 500;
    }

    .card .quote {
      font-style: italic;
      color: #d4af37;
      font-size: 9px;
      padding: 5px 10px;
      border-top: 1px solid rgba(212, 175, 55, 0.3);
      line-height: 1.3;
    }

    /* Category-colored panels - EXACTLY matching print.html */
    /* Stages */
    .card.stage .text-panel,
    .card.stage .prompt-area { background: linear-gradient(to bottom, #2d1f3d, #1f1629); }
    .card.stage .category { color: #c084fc; }
    .card.stage.nigredo .text-panel,
    .card.stage.nigredo .prompt-area { background: linear-gradient(to bottom, #1a1a1a, #0d0d0d); }
    .card.stage.nigredo .category { color: #666; }
    .card.stage.albedo .text-panel,
    .card.stage.albedo .prompt-area { background: linear-gradient(to bottom, #3d3d3d, #2a2a2a); }
    .card.stage.albedo .category { color: #e0e0e0; }
    .card.stage.citrinitas .text-panel,
    .card.stage.citrinitas .prompt-area { background: linear-gradient(to bottom, #4d4020, #3d3018); }
    .card.stage.citrinitas .category { color: #f5c542; }
    .card.stage.rubedo .text-panel,
    .card.stage.rubedo .prompt-area { background: linear-gradient(to bottom, #4d1a20, #3d1018); }
    .card.stage.rubedo .category { color: #e63946; }

    /* Operations */
    .card.operation .text-panel,
    .card.operation .prompt-area { background: linear-gradient(to bottom, #4d2a10, #3d2008); }
    .card.operation .category { color: #ff8c42; }

    /* Elements */
    .card.element .text-panel,
    .card.element .prompt-area { background: linear-gradient(to bottom, #1a3d3a, #132d2b); }
    .card.element .category { color: #4ecdc4; }
    .card.element.fire .text-panel,
    .card.element.fire .prompt-area { background: linear-gradient(to bottom, #4d1a1a, #3d1313); }
    .card.element.fire .category { color: #e63946; }
    .card.element.water .text-panel,
    .card.element.water .prompt-area { background: linear-gradient(to bottom, #1a2a4d, #132039); }
    .card.element.water .category { color: #457b9d; }
    .card.element.air .text-panel,
    .card.element.air .prompt-area { background: linear-gradient(to bottom, #2a3d4d, #1f2f3d); }
    .card.element.air .category { color: #a8dadc; }
    .card.element.earth .text-panel,
    .card.element.earth .prompt-area { background: linear-gradient(to bottom, #2d3d1a, #1f2d13); }
    .card.element.earth .category { color: #606c38; }
    .card.element.quintessence .text-panel,
    .card.element.quintessence .prompt-area { background: linear-gradient(to bottom, #2d1f4d, #1f1639); }
    .card.element.quintessence .category { color: #6c5ce7; }

    /* Principles */
    .card.principle .text-panel,
    .card.principle .prompt-area { background: linear-gradient(to bottom, #4a3d10, #3d3008); }
    .card.principle .category { color: #ffd166; }

    /* Vessels */
    .card.vessel .text-panel,
    .card.vessel .prompt-area { background: linear-gradient(to bottom, #3d2a1a, #2d1f13); }
    .card.vessel .category { color: #d4a574; }

    /* Sages */
    .card.sage .text-panel,
    .card.sage .prompt-area { background: linear-gradient(to bottom, #1a2a3d, #131f2d); }
    .card.sage .category { color: #60a5fa; }

    /* Arcana */
    .card.arcana .text-panel,
    .card.arcana .prompt-area { background: linear-gradient(to bottom, #3d1a3d, #2d132d); }
    .card.arcana .category { color: #e879f9; }

    /* === RATING PANEL === */
    .rating-panel {
      flex: 1;
      max-width: 600px;
    }

    .rating-section {
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
    }

    .rating-section h3 {
      margin-bottom: 15px;
      color: #d4af37;
      font-family: 'Cinzel', serif;
      font-size: 1rem;
    }

    .rating-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .rating-btn {
      flex: 1;
      padding: 15px;
      border: 2px solid #444;
      background: transparent;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }

    .rating-btn:hover {
      border-color: #666;
      background: rgba(255,255,255,0.05);
    }

    .rating-btn.selected {
      border-color: #d4af37;
      background: rgba(212, 175, 55, 0.1);
    }

    .rating-btn .emoji { font-size: 2rem; }
    .rating-btn .label { color: #aaa; font-size: 0.8rem; }
    .rating-btn.selected .label { color: #d4af37; }

    .rating-btn.thumbs-up.selected { border-color: #4ade80; background: rgba(74, 222, 128, 0.1); }
    .rating-btn.thumbs-up.selected .label { color: #4ade80; }
    .rating-btn.meh.selected { border-color: #fbbf24; background: rgba(251, 191, 36, 0.1); }
    .rating-btn.meh.selected .label { color: #fbbf24; }
    .rating-btn.thumbs-down.selected { border-color: #f87171; background: rgba(248, 113, 113, 0.1); }
    .rating-btn.thumbs-down.selected .label { color: #f87171; }

    /* Prompt sections */
    .prompt-section {
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
    }

    .prompt-section label {
      display: block;
      margin-bottom: 6px;
      color: #888;
      font-size: 0.85rem;
    }

    .prompt-section .current-prompt {
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
      color: #aaa;
      line-height: 1.4;
      background: rgba(0,0,0,0.3);
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #333;
    }

    textarea {
      width: 100%;
      padding: 10px;
      border: 2px solid #444;
      background: #222;
      color: #eee;
      border-radius: 6px;
      font-family: inherit;
      font-size: 0.9rem;
      resize: vertical;
      min-height: 80px;
    }

    textarea:focus {
      outline: none;
      border-color: #d4af37;
    }

    textarea::placeholder { color: #666; }

    textarea.prompt-edit {
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
    }

    .nav-buttons {
      display: flex;
      gap: 15px;
      justify-content: space-between;
    }

    .nav-btn {
      padding: 12px 30px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Cinzel', serif;
    }

    .nav-btn.prev { background: #333; color: #eee; }
    .nav-btn.prev:hover { background: #444; }
    .nav-btn.next {
      background: linear-gradient(135deg, #d4af37, #f4cf47);
      color: #1a1a2e;
      font-weight: 600;
    }
    .nav-btn.next:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3);
    }
    .nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .filter-buttons {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .filter-btn {
      padding: 6px 14px;
      border: 1px solid #444;
      background: transparent;
      color: #888;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.8rem;
    }

    .filter-btn.active {
      border-color: #d4af37;
      color: #d4af37;
    }

    .summary-section {
      margin-top: 30px;
      padding: 25px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
    }

    .summary-section h2 {
      color: #d4af37;
      font-family: 'Cinzel', serif;
      margin-bottom: 15px;
      font-size: 1.2rem;
    }

    .summary-stats {
      display: flex;
      gap: 25px;
      margin-bottom: 15px;
    }

    .stat { text-align: center; }
    .stat-number { font-size: 1.8rem; font-weight: bold; }
    .stat-label { color: #888; font-size: 0.85rem; }
    .stat.good .stat-number { color: #4ade80; }
    .stat.meh .stat-number { color: #fbbf24; }
    .stat.bad .stat-number { color: #f87171; }

    .export-btn {
      padding: 12px 25px;
      background: #d4af37;
      color: #1a1a2e;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Cinzel', serif;
    }

    .keyboard-hint {
      text-align: center;
      color: #666;
      font-size: 0.75rem;
      margin-top: 15px;
    }

    .keyboard-hint kbd {
      background: #333;
      padding: 2px 6px;
      border-radius: 4px;
      margin: 0 2px;
    }

    @media (max-width: 1000px) {
      .review-area {
        flex-direction: column;
        align-items: center;
      }
      .card {
        transform: scale(1.3);
        margin-bottom: 80px;
        margin-right: 0;
      }
      .rating-panel {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Alchemy Deck Review</h1>
      <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="progress-text" id="progressText">Card 1 of 34</div>

      <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all">All (34)</button>
        <button class="filter-btn" data-filter="unreviewed">Unreviewed</button>
        <button class="filter-btn" data-filter="up">Approved</button>
        <button class="filter-btn" data-filter="meh">Needs Work</button>
        <button class="filter-btn" data-filter="down">Rejected</button>
      </div>
    </header>

    <div class="review-area">
      <div class="card-wrapper">
        <div class="card" id="cardElement">
          <div class="artwork">
            <img id="cardImage" src="" alt="">
          </div>
          <div class="text-panel">
            <div class="category" id="cardCategory"></div>
            <div class="title" id="cardTitle"></div>
            <div class="subtitle" id="cardSubtitle"></div>
          </div>
          <div class="prompt-area" id="cardPrompt"></div>
          <div class="quote" id="cardQuote"></div>
        </div>
      </div>

      <div class="rating-panel">
        <div class="rating-section">
          <h3>Rate this card</h3>
          <div class="rating-buttons">
            <button class="rating-btn thumbs-up" data-rating="up">
              <span class="emoji">üëç</span>
              <span class="label">Good to print</span>
            </button>
            <button class="rating-btn meh" data-rating="meh">
              <span class="emoji">üòê</span>
              <span class="label">Needs tweaking</span>
            </button>
            <button class="rating-btn thumbs-down" data-rating="down">
              <span class="emoji">üëé</span>
              <span class="label">Regenerate</span>
            </button>
          </div>

          <div class="prompt-section">
            <label>Current Image Prompt:</label>
            <div class="current-prompt" id="currentPrompt"></div>
          </div>

          <div class="prompt-section">
            <label>Revised Prompt (edit to improve):</label>
            <textarea id="revisedPrompt" class="prompt-edit" placeholder="Edit the prompt above to improve the image..."></textarea>
          </div>

          <div class="prompt-section">
            <label>Comments / Notes:</label>
            <textarea id="commentInput" placeholder="e.g., 'Image too dark', 'Quote doesn't fit theme'..."></textarea>
          </div>
        </div>

        <div class="nav-buttons">
          <button class="nav-btn prev" id="prevBtn">‚Üê Previous</button>
          <button class="nav-btn next" id="nextBtn">Next ‚Üí</button>
        </div>

        <div class="keyboard-hint">
          <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> navigate &nbsp; <kbd>1</kbd> approve &nbsp; <kbd>2</kbd> meh &nbsp; <kbd>3</kbd> reject
        </div>
      </div>
    </div>

    <div class="summary-section" id="summarySection" style="display: none;">
      <h2>Review Summary</h2>
      <div class="summary-stats">
        <div class="stat good">
          <div class="stat-number" id="goodCount">0</div>
          <div class="stat-label">Approved</div>
        </div>
        <div class="stat meh">
          <div class="stat-number" id="mehCount">0</div>
          <div class="stat-label">Needs Work</div>
        </div>
        <div class="stat bad">
          <div class="stat-number" id="badCount">0</div>
          <div class="stat-label">Rejected</div>
        </div>
      </div>
      <button class="export-btn" id="exportBtn">Export Review Data (JSON)</button>
    </div>
  </div>

  <script>
    const BASE_STYLE = "Detailed alchemical engraving illustration, hand-tinted with muted earth tones and gold accents, copper and sepia coloring, mystical Renaissance style, intricate linework, esoteric symbolism, aged parchment texture, high detail, centered composition with clear borders, print-ready quality, no text or letters";

    const cards = [
      // STAGES - The Four Stages of the Magnum Opus
      {
        id: "stage-01", type: "stage", subtype: "nigredo",
        category: "Stage", title: "Nigredo", subtitle: "Blackening",
        prompt: "The dark night. What must die for transformation to begin? What shadow must you face?",
        quote: '"I am black, white, yellow, and red." ‚ÄîMaier, Atalanta Fugiens',
        imagePrompt: "Blackening stage of alchemy, dark ravens, decomposing matter, black sun, shadowy cauldron with dark smoke, skull and bones, death and putrefaction symbolism"
      },
      {
        id: "stage-02", type: "stage", subtype: "albedo",
        category: "Stage", title: "Albedo", subtitle: "Whitening",
        prompt: "The washing. What is being purified? What clarity is emerging from chaos?",
        quote: '"Water washes and purifies all imperfect things." ‚ÄîSendivogius, New Chemical Light',
        imagePrompt: "Whitening stage of alchemy, white dove, lunar symbolism, silver moon, purified white substance in vessel, pearl, snow white rose, washing and cleansing"
      },
      {
        id: "stage-03", type: "stage", subtype: "citrinitas",
        category: "Stage", title: "Citrinitas", subtitle: "Yellowing",
        prompt: "The dawning. What wisdom is emerging? What is coming into consciousness?",
        quote: '"The vulture cries: I am white and black, yellow and red." ‚ÄîMaier',
        imagePrompt: "Yellowing stage of alchemy, golden dawn rising, solar symbolism, yellow sulfur, awakening consciousness, golden light breaking through, sunrise over alchemical landscape"
      },
      {
        id: "stage-04", type: "stage", subtype: "rubedo",
        category: "Stage", title: "Rubedo", subtitle: "Reddening",
        prompt: "The completion. What wholeness is possible? What is being integrated?",
        quote: '"Fire purifies all fixed things and by fire they are perfected." ‚ÄîSendivogius',
        imagePrompt: "Reddening stage of alchemy, phoenix rising from flames, red stone, completion of the great work, royal marriage of sun and moon, red rose, blood red elixir"
      },

      // OPERATIONS - The Seven Alchemical Operations
      {
        id: "op-01", type: "operation",
        category: "Operation", title: "Calcination", subtitle: "Burning",
        prompt: "Reduction by fire. What must be burned away? What attachments need releasing?",
        quote: '"All impurities of things are purified by fire." ‚ÄîSendivogius',
        imagePrompt: "Alchemical calcination, fierce flames burning matter to white ash, fire consuming base materials, salamander in flames, burning crucible"
      },
      {
        id: "op-02", type: "operation",
        category: "Operation", title: "Dissolution", subtitle: "Dissolving",
        prompt: "Breaking down in water. What structures need to dissolve? Where must you surrender?",
        quote: '"Water joins together everything that is dissolved." ‚ÄîSendivogius',
        imagePrompt: "Alchemical dissolution, matter dissolving in water, tears and rain, moon reflected in pool, sea serpent, watery depths, dissolution of form"
      },
      {
        id: "op-03", type: "operation",
        category: "Operation", title: "Separation", subtitle: "Discerning",
        prompt: "Sorting and discerning. What must be separated? What distinction needs making?",
        quote: '"Fire separates everything that is joined." ‚ÄîSendivogius',
        imagePrompt: "Alchemical separation, sword dividing light and dark, eagle and toad separating, filter and strainer, wheat from chaff, discernment"
      },
      {
        id: "op-04", type: "operation",
        category: "Operation", title: "Conjunction", subtitle: "Uniting",
        prompt: "Marriage of opposites. What opposites seek union? What must be joined?",
        quote: '"The fixed and volatile are united into one." ‚ÄîKhunrath',
        imagePrompt: "Alchemical conjunction, sacred marriage, king and queen uniting, sun and moon joining, hermaphrodite, chemical wedding, two becoming one"
      },
      {
        id: "op-05", type: "operation",
        category: "Operation", title: "Fermentation", subtitle: "Inspiring",
        prompt: "New life from decay. What new life is fermenting? What inspiration is arising?",
        quote: '"Nature gives motion, motion excites air, air excites fire." ‚ÄîSendivogius',
        imagePrompt: "Alchemical fermentation, peacock tail colors, rotting fruit giving rise to new life, bacteria and yeast, bubbling ferment, inspiration arising"
      },
      {
        id: "op-06", type: "operation",
        category: "Operation", title: "Distillation", subtitle: "Refining",
        prompt: "Extracting essence. What is the essence? What needs further refinement?",
        quote: '"The spirit is sublimed and the body remains below." ‚ÄîKhunrath',
        imagePrompt: "Alchemical distillation, alembic with rising vapors, condensing spirit, dew drops, eagle ascending, purified essence rising"
      },
      {
        id: "op-07", type: "operation",
        category: "Operation", title: "Coagulation", subtitle: "Manifesting",
        prompt: "Making solid. What is ready to manifest? How does spirit become matter?",
        quote: '"According to the matrix, various things are produced." ‚ÄîSendivogius',
        imagePrompt: "Alchemical coagulation, philosopher's stone forming, crystallization, solid gold emerging, phoenix egg, manifested perfection"
      },

      // ELEMENTS - The Five Elements
      {
        id: "elem-01", type: "element", subtype: "fire",
        category: "Element", title: "Fire", subtitle: "Will",
        prompt: "The transforming principle. Where is the fire? What needs transforming action?",
        quote: '"Fire separates, purifies, digests, and colors." ‚ÄîSendivogius',
        imagePrompt: "Elemental fire, roaring flames, salamander, triangle pointing up, solar rays, burning torch, transformative fire, volcanic"
      },
      {
        id: "elem-02", type: "element", subtype: "water",
        category: "Element", title: "Water", subtitle: "Emotion",
        prompt: "The dissolving principle. What are the feelings? What needs to flow?",
        quote: '"Water washes and purifies all imperfect things." ‚ÄîSendivogius',
        imagePrompt: "Elemental water, flowing streams, undine water spirit, triangle pointing down, lunar tides, fish and waves, dissolving waters"
      },
      {
        id: "elem-03", type: "element", subtype: "air",
        category: "Element", title: "Air", subtitle: "Thought",
        prompt: "The communicating principle. What thoughts are present? What needs communicating?",
        quote: '"Motion excites air, air excites fire." ‚ÄîSendivogius',
        imagePrompt: "Elemental air, swirling winds, sylph air spirit, birds in flight, clouds and sky, breath of life, intellectual clarity"
      },
      {
        id: "elem-04", type: "element", subtype: "earth",
        category: "Element", title: "Earth", subtitle: "Body",
        prompt: "The grounding principle. What is the material reality? What needs grounding?",
        quote: '"Earth receives the Tincture." ‚ÄîSendivogius',
        imagePrompt: "Elemental earth, fertile soil, gnome earth spirit, mountains and caves, crystals growing, roots and stones, material foundation"
      },
      {
        id: "elem-05", type: "element", subtype: "quintessence",
        category: "Element", title: "Quintessence", subtitle: "Spirit",
        prompt: "The fifth element. What is the spiritual dimension? What transcends?",
        quote: '"The Quintessence is eternal, immutable, perfect in all elements." ‚ÄîDrebbel',
        imagePrompt: "Fifth element quintessence, starry cosmos, spiraling galaxy, divine light, ethereal spirit, transcendent essence, celestial sphere"
      },

      // PRINCIPLES - The Tria Prima
      {
        id: "prin-01", type: "principle",
        category: "Principle", title: "Sulphur", subtitle: "Soul",
        prompt: "The combustible principle. What does the soul desire? What animates this?",
        quote: '"Fire, Sulphur; Salt, Balsam; Mercury, the three called Prima Materia." ‚ÄîParacelsus',
        imagePrompt: "Alchemical sulphur principle, burning sun, masculine fire, active soul force, golden flames, combustible spirit, solar king"
      },
      {
        id: "prin-02", type: "principle",
        category: "Principle", title: "Mercury", subtitle: "Spirit",
        prompt: "The volatile principle. What message is being carried? What moves between realms?",
        quote: '"From living quicksilver comes the prima materia." ‚ÄîRosicrucian MS',
        imagePrompt: "Alchemical mercury principle, winged messenger, caduceus staff, quicksilver flowing, volatile spirit, hermaphrodite, mediating force"
      },
      {
        id: "prin-03", type: "principle",
        category: "Principle", title: "Salt", subtitle: "Body",
        prompt: "The fixed principle. What is the body of this? What form does it take?",
        quote: '"The Sun is fire, salt, and base." ‚ÄîParacelsus, Book of Meteors',
        imagePrompt: "Alchemical salt principle, crystalline cube, fixed body, material form, white salt crystals, foundation stone, preserved form"
      },

      // VESSELS - Alchemical Apparatus
      {
        id: "vessel-01", type: "vessel",
        category: "Vessel", title: "Athanor", subtitle: "The Furnace",
        prompt: "Sustained heat over time. What requires sustained attention? Where is patience needed?",
        quote: '"With one Athanor furnace; and one fire." ‚ÄîKhunrath, Amphitheater',
        imagePrompt: "Alchemical athanor furnace, tower furnace with sustained flame, philosophical egg inside, patient fire, brick oven, steady heat"
      },
      {
        id: "vessel-02", type: "vessel",
        category: "Vessel", title: "Alembic", subtitle: "The Still",
        prompt: "The vessel of distillation. What needs distilling? How to extract the essence?",
        quote: '"The spirit is sublimed from the body." ‚ÄîKhunrath',
        imagePrompt: "Alchemical alembic still, glass distillation apparatus, condensing head, vapor rising and falling, drop of essence, copper still"
      },
      {
        id: "vessel-03", type: "vessel",
        category: "Vessel", title: "Crucible", subtitle: "The Test",
        prompt: "The vessel of trial. What is being tested? What must withstand the fire?",
        quote: '"The body is corrupted, dies, turns black, reduced to ashes." ‚ÄîKhunrath',
        imagePrompt: "Alchemical crucible, melting pot in fierce fire, molten gold, testing vessel, trial by fire, ceramic pot glowing red"
      },
      {
        id: "vessel-04", type: "vessel",
        category: "Vessel", title: "Retort", subtitle: "The Return",
        prompt: "The vessel of circulation. What needs to circulate? What must return to its source?",
        quote: '"It always begins there where it ends." ‚ÄîHermes, Pymander',
        imagePrompt: "Alchemical retort vessel, bent-neck flask, circulating vapors, pelican vessel, philosophical circulation, returning to source"
      },

      // SAGES - Alchemical Masters
      {
        id: "sage-01", type: "sage",
        category: "Sage", title: "Hermes", subtitle: "Trismegistus",
        prompt: "The thrice-great. How does the macrocosm mirror the microcosm?",
        quote: '"Man bore the image of his father, for God delighted in his own form." ‚ÄîPymander',
        imagePrompt: "Hermes Trismegistus, Egyptian-Greek sage, emerald tablet, ibis bird, caduceus, pyramids, thrice-great master, as above so below"
      },
      {
        id: "sage-02", type: "sage",
        category: "Sage", title: "Paracelsus", subtitle: "The Physician",
        prompt: "Nature as teacher. What does nature teach here? What is the medicine?",
        quote: '"These three are Prima Materia, like God, namely Materia Prima." ‚ÄîBook of Meteors',
        imagePrompt: "Paracelsus the physician, Renaissance doctor, sword Azoth, medical herbs, alchemical medicine, natural philosophy, healing arts"
      },
      {
        id: "sage-03", type: "sage",
        category: "Sage", title: "Boehme", subtitle: "The Mystic",
        prompt: "Divine spark in all things. What is the divine spark here? What vision is possible?",
        quote: '"Heaven is the Firmament, the Sea of Fire, from the 7 Spirits of Nature." ‚ÄîAurora',
        imagePrompt: "Jacob Boehme mystic, shoemaker sage, divine vision, aurora dawn light, mystical eye, theosophical symbols, spiritual illumination"
      },
      {
        id: "sage-04", type: "sage",
        category: "Sage", title: "Ficino", subtitle: "The Translator",
        prompt: "The soul's journey. What is the soul's path here? Where is the beauty?",
        quote: '"Hermes Trismegistus attempted to eradicate this stain from souls." ‚ÄîOn Pleasure',
        imagePrompt: "Marsilio Ficino, Florentine philosopher, translating ancient texts, lyre music, platonic academy, Renaissance humanism, beauty and soul"
      },
      {
        id: "sage-05", type: "sage",
        category: "Sage", title: "Sendivogius", subtitle: "The Adept",
        prompt: "The new light. What does practical wisdom say? What is the clear path?",
        quote: '"Nature gives motion, motion excites air, air excites fire." ‚ÄîNew Chemical Light',
        imagePrompt: "Michael Sendivogius, Polish alchemist, new chemical light, practical laboratory, philosophical mercury, adept in robes, transmutation"
      },
      {
        id: "sage-06", type: "sage",
        category: "Sage", title: "Agrippa", subtitle: "The Magus",
        prompt: "Hidden philosophy. What hidden forces are at work? What correspondences apply?",
        quote: '"Whence come the hidden virtues of things." ‚ÄîThree Books of Occult Philosophy',
        imagePrompt: "Cornelius Agrippa, occult philosopher, three books of magic, pentagram, celestial correspondences, hidden wisdom, magical arts"
      },

      // ARCANA - Sacred Mysteries
      {
        id: "arc-01", type: "arcana",
        category: "Arcana", title: "Prima Materia", subtitle: "First Matter",
        prompt: "Chaos before creation. What is the raw material? What potential lies unformed?",
        quote: '"The Prima Materia is a divine mist, issuing from God\'s Paradise." ‚ÄîHellwig',
        imagePrompt: "Prima materia first matter, chaotic void, unformed potential, cosmic egg, dark waters of creation, primordial chaos, divine mist"
      },
      {
        id: "arc-02", type: "arcana",
        category: "Arcana", title: "Lapis", subtitle: "The Stone",
        prompt: "The philosopher's stone. What is the goal? What would complete the work?",
        quote: '"The fixed becomes volatile; the volatile, fixed; a new World established." ‚ÄîKhunrath',
        imagePrompt: "Philosopher's stone lapis, radiant red stone, perfect gem, transmuting gold, completed work, ruby crystal, ultimate achievement"
      },
      {
        id: "arc-03", type: "arcana",
        category: "Arcana", title: "Ouroboros", subtitle: "Eternal Return",
        prompt: "The serpent eating its tail. What cycle is completing? What contains its own renewal?",
        quote: '"It always begins there where it ends." ‚ÄîHermes, Pymander',
        imagePrompt: "Ouroboros serpent, dragon eating its tail, eternal cycle, infinity symbol, self-renewal, beginning and end united, cosmic snake"
      },
      {
        id: "arc-04", type: "arcana",
        category: "Arcana", title: "Rebis", subtitle: "The Double",
        prompt: "Union of sun and moon. What dualities seek resolution? What would integration look like?",
        quote: '"He wished to create, and fell to the sphere of generation." ‚ÄîPymander',
        imagePrompt: "Rebis double nature, hermaphrodite figure, sun and moon united, male and female merged, two-headed being, perfect union"
      },
      {
        id: "arc-05", type: "arcana",
        category: "Arcana", title: "Elixir", subtitle: "The Medicine",
        prompt: "Universal medicine. What is the medicine needed? What would heal this?",
        quote: '"The true Elixir results from Sun and Mercury through the Quintessence." ‚ÄîRosicrucian MS',
        imagePrompt: "Elixir of life, golden liquid in vessel, universal medicine, panacea, immortality potion, healing draught, perfected tincture"
      }
    ];

    let currentIndex = 0;
    let currentFilter = 'all';
    let filteredCards = [...cards];
    let reviews = JSON.parse(localStorage.getItem('alchemyDeckReviews') || '{}');

    const cardElement = document.getElementById('cardElement');
    const cardImage = document.getElementById('cardImage');
    const cardCategory = document.getElementById('cardCategory');
    const cardTitle = document.getElementById('cardTitle');
    const cardSubtitle = document.getElementById('cardSubtitle');
    const cardPrompt = document.getElementById('cardPrompt');
    const cardQuote = document.getElementById('cardQuote');
    const currentPromptEl = document.getElementById('currentPrompt');
    const revisedPromptEl = document.getElementById('revisedPrompt');
    const commentInput = document.getElementById('commentInput');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const summarySection = document.getElementById('summarySection');

    function applyFilter(filter) {
      currentFilter = filter;
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === filter);
      });

      if (filter === 'all') filteredCards = [...cards];
      else if (filter === 'unreviewed') filteredCards = cards.filter(c => !reviews[c.id]?.rating);
      else filteredCards = cards.filter(c => reviews[c.id]?.rating === filter);

      currentIndex = 0;
      updateDisplay();
      updateFilterCounts();
    }

    function updateFilterCounts() {
      const counts = {
        all: cards.length,
        unreviewed: cards.filter(c => !reviews[c.id]?.rating).length,
        up: cards.filter(c => reviews[c.id]?.rating === 'up').length,
        meh: cards.filter(c => reviews[c.id]?.rating === 'meh').length,
        down: cards.filter(c => reviews[c.id]?.rating === 'down').length
      };
      document.querySelectorAll('.filter-btn').forEach(btn => {
        const filter = btn.dataset.filter;
        const label = filter === 'all' ? 'All' : filter === 'unreviewed' ? 'Unreviewed' : filter === 'up' ? 'Approved' : filter === 'meh' ? 'Needs Work' : 'Rejected';
        btn.textContent = `${label} (${counts[filter]})`;
      });
    }

    function updateDisplay() {
      if (filteredCards.length === 0) {
        cardImage.src = '';
        cardCategory.textContent = '';
        cardTitle.textContent = 'No cards';
        cardSubtitle.textContent = '';
        cardPrompt.textContent = 'Try a different filter.';
        cardQuote.textContent = '';
        currentPromptEl.textContent = '';
        return;
      }

      const card = filteredCards[currentIndex];
      const review = reviews[card.id] || {};

      // Update card class for category color
      let cardClass = `card ${card.type}`;
      if (card.subtype) cardClass += ` ${card.subtype}`;
      cardElement.className = cardClass;

      cardImage.src = `cards/${card.id}.png`;
      cardImage.alt = card.title;
      cardCategory.textContent = card.category;
      cardTitle.textContent = card.title;
      cardSubtitle.textContent = card.subtitle;
      cardPrompt.textContent = card.prompt;
      cardQuote.textContent = card.quote;

      // Show current and revised prompts
      const fullPrompt = `${BASE_STYLE}, ${card.imagePrompt}`;
      currentPromptEl.textContent = fullPrompt;
      revisedPromptEl.value = review.revisedPrompt || '';
      commentInput.value = review.comment || '';

      document.querySelectorAll('.rating-btn').forEach(btn => {
        btn.classList.toggle('selected', btn.dataset.rating === review.rating);
      });

      const progress = ((currentIndex + 1) / filteredCards.length) * 100;
      progressBar.style.width = `${progress}%`;
      progressText.textContent = `Card ${currentIndex + 1} of ${filteredCards.length}`;

      prevBtn.disabled = currentIndex === 0;
      nextBtn.textContent = currentIndex === filteredCards.length - 1 ? 'Finish' : 'Next ‚Üí';

      updateSummary();
    }

    function saveReview(rating) {
      const card = filteredCards[currentIndex];
      if (!reviews[card.id]) reviews[card.id] = {};
      reviews[card.id].rating = rating;
      reviews[card.id].comment = commentInput.value;
      reviews[card.id].revisedPrompt = revisedPromptEl.value;
      reviews[card.id].timestamp = new Date().toISOString();
      localStorage.setItem('alchemyDeckReviews', JSON.stringify(reviews));
      updateDisplay();
      updateFilterCounts();
    }

    function saveInputs() {
      const card = filteredCards[currentIndex];
      if (!reviews[card.id]) reviews[card.id] = {};
      reviews[card.id].comment = commentInput.value;
      reviews[card.id].revisedPrompt = revisedPromptEl.value;
      localStorage.setItem('alchemyDeckReviews', JSON.stringify(reviews));
    }

    function updateSummary() {
      const reviewedCount = Object.keys(reviews).filter(k => reviews[k].rating).length;
      if (reviewedCount > 0) {
        summarySection.style.display = 'block';
        document.getElementById('goodCount').textContent = Object.values(reviews).filter(r => r.rating === 'up').length;
        document.getElementById('mehCount').textContent = Object.values(reviews).filter(r => r.rating === 'meh').length;
        document.getElementById('badCount').textContent = Object.values(reviews).filter(r => r.rating === 'down').length;
      }
    }

    function exportReviews() {
      const exportData = {
        exported: new Date().toISOString(),
        baseStyle: BASE_STYLE,
        summary: {
          total: cards.length,
          approved: Object.values(reviews).filter(r => r.rating === 'up').length,
          needsWork: Object.values(reviews).filter(r => r.rating === 'meh').length,
          rejected: Object.values(reviews).filter(r => r.rating === 'down').length,
          unreviewed: cards.filter(c => !reviews[c.id]?.rating).length
        },
        cards: cards.map(card => ({
          ...card,
          fullPrompt: `${BASE_STYLE}, ${card.imagePrompt}`,
          review: reviews[card.id] || { rating: null, comment: '', revisedPrompt: '' }
        }))
      };
      const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `alchemy-deck-review-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
    }

    document.querySelectorAll('.rating-btn').forEach(btn => btn.addEventListener('click', () => saveReview(btn.dataset.rating)));
    document.querySelectorAll('.filter-btn').forEach(btn => btn.addEventListener('click', () => applyFilter(btn.dataset.filter)));
    commentInput.addEventListener('blur', saveInputs);
    revisedPromptEl.addEventListener('blur', saveInputs);
    prevBtn.addEventListener('click', () => { saveInputs(); if (currentIndex > 0) { currentIndex--; updateDisplay(); } });
    nextBtn.addEventListener('click', () => { saveInputs(); if (currentIndex < filteredCards.length - 1) { currentIndex++; updateDisplay(); } });
    document.getElementById('exportBtn').addEventListener('click', exportReviews);

    document.addEventListener('keydown', (e) => {
      if (e.target === commentInput || e.target === revisedPromptEl) return;
      if (e.key === 'ArrowLeft' && currentIndex > 0) { saveInputs(); currentIndex--; updateDisplay(); }
      else if (e.key === 'ArrowRight' && currentIndex < filteredCards.length - 1) { saveInputs(); currentIndex++; updateDisplay(); }
      else if (e.key === '1') saveReview('up');
      else if (e.key === '2') saveReview('meh');
      else if (e.key === '3') saveReview('down');
    });

    updateDisplay();
    updateFilterCounts();
  </script>
</body>
</html>

